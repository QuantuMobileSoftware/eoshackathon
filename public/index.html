<!DOCTYPE html>
<html>
	<head>
		<title>Simple counter</title>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<script src="eos.js"></script>
	</head>
	<body>
		<div>PK</div>
		<input type="text" value="5Ht9SziuuAFjNLs21acJPaT2Zgowjb6LodhGpCkUVHC5yYmzXWE" id="pk" />
		<div>Counter value</div><div id="result"></div>
		<input type="number" value="1" id="val" />
		<input type="button" value="Add" id="addButton" />
		<input type="button" value="Subtract" id="subtractButton" />
		<input type="button" value="Set" id="setButton" />
		<script>
                        var eos = Eos({
                            httpEndpoint: 'http://localhost:8888',
                            keyProvider: document.getElementById('pk').value,
                            debug: true
                        });

                        function pushAction(name) {
                            var data = {val: parseInt(document.getElementById('val').value)};
                            eos.transaction({
                                actions: [
                                    {
                                        account: 'decidex',
                                        name: name,
                                        authorization: [{
                                                actor: 'test',
                                                permission: 'active'
                                            }],
                                        data: data
                                    }
                                ]
                            }).then(result => console.log(result));
                        }

                        document.getElementById("addButton").addEventListener("click", function () {
                            pushAction('add');
                        });
                        document.getElementById("subtractButton").addEventListener("click", function () {
                            pushAction('subtract');
                        });
                        document.getElementById("setButton").addEventListener("click", function () {
                            pushAction('set');
                        });

                        var controlWebsocket = new WebSocket("ws://" + window.location.hostname + ":1337/" + window.location.search);
                        controlWebsocket.onopen = function () {
                        };
                        controlWebsocket.onclose = function () {
                        };
		</script>
	</body>
</html>
